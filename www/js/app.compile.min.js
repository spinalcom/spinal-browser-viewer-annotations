(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()({1:[function(require,module,exports){
"use strict";angular.module("settings",[]).constant("config",{main_path:"/",spinalhub_url:"127.0.0.1",spinalhub_port:"8888",spinalhub_user:"168"});

},{}],2:[function(require,module,exports){
"use strict";angular.module("app.route",["ngRoute"]),angular.module("app.services",[]),angular.module("app.directives",[]),angular.module("app.controllers",[]),angular.module("app.spinalcom",["settings","ngMaterial"]),angular.module("app.spinalforge.plugin",[]),angular.module("SpinalApp",["ngAnimate","ngMaterial","app.directives","app.route","app.services","app.controllers","ngMdIcons","settings","app.spinalcom","app.spinalforge.plugin","colorpicker.module"]).run(["$rootScope","$location","authService",function(e,a,t){var n=t.get_user();e.$on("$routeChangeStart",function(e,o,r){o.$$route.authenticate&&(t.is_Connected()||t.login(n.username,n.password).then(function(){},function(){a.path("/login")}))})}]).config(["$mdThemingProvider",function(e){e.theme("altTheme").primaryPalette("grey",{default:"200"}).accentPalette("grey",{default:"700"}).dark(),e.theme("default").dark(),e.setDefaultTheme("altTheme"),e.alwaysWatchTheme(!0)}]).run(["$templateCache","$http",function(e,a){for(var t=function(t,n){a.get(t).then(function(a){e.put(n,a.data)},function(e){console.log("Cannot load the file "+t)})},n=[{uri:"app/templates/forgeviewer.html",name:"forgeviewer.html"}],o=0;o<n.length;o++)t(n[o].uri,n[o].name)}]);

},{}],3:[function(require,module,exports){
"use strict";angular.module("app.route").config(["$routeProvider","$locationProvider",function(e,t){e.when("/viewer/:filepath",{templateUrl:"app/templates/main.html",authenticate:!0,controller:"mainCtrl"}).when("/login",{templateUrl:"app/templates/login.html",authenticate:!1,controller:"loginCtrl"}).when("/404",{authenticate:!1,controller:["$location",function(e){e.replace("/drive/")}]}).otherwise({redirectTo:"/404"})}]);

},{}],4:[function(require,module,exports){
"use strict";angular.module("app.spinalforge.plugin").controller("forgeViewerCtrl",["$scope","$rootScope","$mdDialog","authService","$compile","$injector","layout_uid","spinalModelDictionary",function(e,o,n,t,i,r,a,u){e.injector=r,e.uid=a.get(),console.log("forgeviewerCtrl start"),o.allNotes=[],u.init().then(function(o){var n,t;console.log("forgeviewerCtrl start 2");var i={extensions:["Autodesk.ADN.Viewing.Extension.Color","PannelendPoint"]},r={env:"AutodeskProduction",accessToken:""};function onDocumentLoadSuccess(e){0!==(t=n.bubble.search({type:"geometry",role:"3d"})).length?n.selectItem(t[t.length-1].data,onItemLoadSuccess,onItemLoadFail):console.error("Document contains no viewables.")}function onDocumentLoadFailure(e){console.error("onDocumentLoadFailure() - errorCode:"+e)}function onItemLoadSuccess(o,t){o.scope=e,console.log("Viewers are equal: "+(o===n.getCurrentViewer()))}function onItemLoadFail(e){console.error("onItemLoadFail() - errorCode:"+e)}!function(e,o,n){e.oauth.set(""),e.ask_token.set(!0);var t=!0;e.oauth.bind(function oauth_onchange(){t&&""!=e.oauth.get()&&(t=!1,e.oauth.unbind(oauth_onchange),r.accessToken=e.oauth.get(),n(o))})}(o,"urn:"+o.urn.get(),function(o){Autodesk.Viewing.Initializer(r,function(){(n=new Autodesk.Viewing.ViewingApplication("MyViewerDiv"+e.uid)).registerViewer(n.k3D,Autodesk.Viewing.Private.GuiViewer3D,i),n.loadDocument(o,onDocumentLoadSuccess,onDocumentLoadFailure)})})})}]);

},{}],5:[function(require,module,exports){
"use strict";angular.module("app.controllers").controller("loginCtrl",["$scope","authService","$mdToast","$location",function(o,n,t,e){var l=t.simple().hideDelay(3e3);n.get_user();n.logout(),o.conf={email:"",password:""},o.ConnectBtn=function(){n.login(o.conf.email,o.conf.password).then(function(){e.path("/home")},function(o){l.textContent(o),t.show(l)})}}]);

},{}],6:[function(require,module,exports){
"use strict";angular.module("app.controllers").controller("mainCtrl",["$scope","$routeParams","goldenLayoutService","spinalModelDictionary",function(o,r,e,l){e.init()}]);

},{}],7:[function(require,module,exports){
"use strict";angular.module("app.controllers").controller("navbarCtrl",["$scope","authService","$location","$routeParams",function(e,t,o,n){e.username="",e.connected=!1,t.wait_connect().then(function(){e.username=t.get_user().username,e.connected=!0,e.viewer=n.filepath,e.viewer?e.viewer=atob(e.viewer):e.viewer="viewer",console.log(n.filepath)}),e.logout=function(){o.path("/login")},e.layouts=[{id:"drag-viewer",name:"viewer",cfg:{isClosable:!0,title:"viewer",type:"component",componentName:"SpinalHome",componentState:{template:"forgeviewer.html",controller:"forgeViewerCtrl"}}}]}]);

},{}],8:[function(require,module,exports){
"use strict";angular.module("app.directives").directive("navbar",[function(){return{restrict:"E",templateUrl:"app/templates/navbar.html",controller:"navbarCtrl"}}]).directive("menuGlayout",["goldenLayoutService","$timeout",function(t,e){return{restrict:"E",scope:{layoutInfo:"=info"},replace:!0,template:'<li ng-repeat="layout in layoutInfo"  id="{{layout.id}}"><a >{{layout.name}}</a></li>',link:function(e,n,i){t.wait_ready().then(function(){for(var n=function(t,e){return function(){t.createChild(e.cfg)}},i=0;i<e.layoutInfo.length;i++){var r=e.layoutInfo[i];t.createDragSource($("#"+r.id)[0],r.cfg),$("#"+r.id).click(n(t,r))}})}}}]).directive("ngRightClick",["$parse",function(t){return function(e,n,i){var r=t(i.ngRightClick);n.bind("contextmenu",function(t){e.$apply(function(){t.preventDefault(),r(e,{$event:t})})})}}]);

},{}],9:[function(require,module,exports){
(function(e){"use strict";var t=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}angular.module("app.spinalforge.plugin").run(["spinalModelDictionary","$mdDialog","$mdToast","authService","$rootScope","$compile",function(e,n,a,i,l,o){var s=function(){function PannelAnnotation(e,t){var n=this;_classCallCheck(this,PannelAnnotation),Autodesk.Viewing.Extension.call(this,e,t),e.registerContextMenuCallback("rightClickMenu",function(e,t){e.push({title:"See Annotation",target:function(){var e=n.viewer.getSelection();if(1==e.length){document.getElementById("search").value=e[0];var t=document.getElementById("allList");n.getContainer(e[0],function(e){n.changeContainer(t,e)})}else alert("you must select 1 item")}})}),this.viewer=e,this.panel=null,this.user=i.get_user(),this.detailPanelContent=null,this.detailPanel=null,this.filePanel=null,this.filePanelContent=null,this._selected=null,this._sel=null,this._file_selected=null,l.execute_func=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;switch(e){case"addItem":n.AddItems(t);break;case"changeColor":n.changeColorInHub(t);break;case"view":n.viewOrHide(t);break;case"rename":n.renameNote(t);break;case"delete":n.deleteNoteItem(t,a);break;case"info":n.DetailPanel(t);break;case"selectItem":n.selectNote(t);break;case"file":n.DisplayFilePanel(t);break;case"download":n.DownloadFile(t);break;case"delete_file":n.RemoveFile(t)}}}return t(PannelAnnotation,[{key:"load",value:function(){return this.viewer.toolbar?this.createUI():(this.onToolbarCreatedBinded=this.onToolbarCreated.bind(this),this.viewer.addEventListener(av.TOOLBAR_CREATED_EVENT,this.onToolbarCreatedBinded)),!0}},{key:"onToolbarCreated",value:function(){this.viewer.removeEventListener(av.TOOLBAR_CREATED_EVENT,this.onToolbarCreatedBinded),this.onToolbarCreatedBinded=null,this.createUI()}},{key:"unload",value:function(){return this.viewer.toolbar.removeControl(this.subToolbar),!0}},{key:"createUI",value:function(){var e=this;this.panel=new PanelClass(this.viewer,"Annotation"),this.initialize();var t=new Autodesk.Viewing.UI.Button("Annotation");t.onClick=function(t){e.panel.isVisible()?e.panel.setVisible(!1):e.panel.setVisible(!0)},t.addClass("fa"),t.addClass("fa-pencil"),t.addClass("fa-2x"),t.setToolTip("Annotation"),this.subToolbar=new Autodesk.Viewing.UI.ControlGroup("my-Annotation"),this.subToolbar.addControl(t),this.viewer.toolbar.addControl(this.subToolbar)}},{key:"initialize",value:function(){var t=this;this.panel.initializeMoveHandlers(this.panel.container),this.panel.container.appendChild(this.panel.createScrollContainer());var a=this.panel.container,i=function(e){var i=a,l=e;i.className+=" panelViewer";var o=document.createElement("div");o.className="_container";var s=document.createElement("div");s.className="header";var r=document.createElement("div");r.className="spin row head";var d=document.createElement("div");d.className="col-sm-3 col-md-3 col-xs-3";var c=document.createElement("button");c.className="btn btn-primary btn-sm btn-block",c.innerHTML='<i class="fa fa-pencil-square-o" aria-hidden="true"></i> Note',c.onclick=function(){var e=n.prompt().title("New Note").placeholder("Please enter the title").ariaLabel("New Note").clickOutsideToClose(!0).required(!0).ok("Create!").cancel("Cancel");n.show(e).then(function(e){t.AddNote(e)},function(){})};var u=document.createElement("div");u.className="col-sm-3 col-md-3 col-xs-3";var h=document.createElement("button");h.className="btn btn-primary btn-sm btn-block",h.innerHTML='<i class="fa fa-eye" aria-hidden="true"></i> View',h.onclick=function(){t.changeAllItemsColor(),t.changeAllIcon("fa-eye-slash","true")};var m=document.createElement("div");m.className="col-sm-3 col-md-3 col-xs-3";var f=document.createElement("button");f.className="btn btn-primary btn-sm btn-block",f.innerHTML='<i class="fa fa-eye-slash" aria-hidden="true"></i> Hide',f.onclick=function(){t.restoreAllItemsColor(),t.changeAllIcon("fa-eye","false")};var p=document.createElement("div");p.className="list-group allList",p.id="allList";var v=document.createElement("div");v.className="list-group allItems";var g=document.createElement("div");g.className="spin input-group";var b=document.createElement("span");b.className="icon input-group-addon",b.innerHTML='<i class="fa fa-search" aria-hidden="true"></i>';var C=document.createElement("input");C.className="input form-control toolbar-search-box",C.type="number",C.id="search",C.placeholder="item id",C.onclick=function(){C.focus()},C.oninput=function(){""!=C.value?t.getContainer(parseInt(C.value),function(e){t.changeContainer(p,e)}):t.changeContainer(p,l)},d.appendChild(c),u.appendChild(h),m.appendChild(f),r.appendChild(d),r.appendChild(u),r.appendChild(m),s.appendChild(r),g.appendChild(b),g.appendChild(C),s.appendChild(g),o.appendChild(s),o.appendChild(p),o.appendChild(v),i.appendChild(o),l.bind(function(){t.changeContainer(p,l)})};e.init().then(function(e){e&&(e.annotationPlugin?e.annotationPlugin.load(function(e){t.model=e,i(t.model)}):(t.model=new Lst,e.add_attr({annotationPlugin:new Ptr(t.model)}),i(t.model)))})}},{key:"AddNote",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#000000",n=this.model,a=newGUID(),i=new NoteModel;i.title.set(e),i.color.set(t),i.id.set(a),i.date.set(Date.now()),i.owner.set(this.user.id),i.username.set(this.user.username);var l=n;l.push(i),n.mod_attr(l)}},{key:"AddItems",value:function(e){var t,n,i=this.viewer.getSelection(),l=this.model;0!=i.length?this.viewer.model.getBulkProperties(i,{propFilter:["name"]},function(i){for(var o=0;o<l.length;o++)if(l[o].id==e){t=l[o].allObject,n=o;break}for(var s=0;s<i.length;s++)t.push(i[s]);l[n].allObject=t;var r=a.simple().content("Item added !").highlightAction(!0).position("bottom right").parent("body");a.show(r)},function(){console.log("error")}):alert("No model selected !")}},{key:"getContainer",value:function(e,t){t(this.model.filter(function(t){return t.allObject.filter(function(t){return t.dbId.get()==e}).length>0}))}},{key:"changeColorInHub",value:function(e,t){for(var n=this.model,a=0;a<n.length;a++)n[a].id==e&&n[a].color.set(t)}},{key:"changeItemColor",value:function(e){for(var t,n=[],a=this.model,i=0;i<a.length;i++)if(a[i].id==e){t=a[i];for(var l=0;l<t.allObject.length;l++)n.push(t.allObject[l].dbId.get())}this.viewer.setColorMaterial(n,t.color.get(),t.id.get())}},{key:"restoreColor",value:function(e){for(var t,n=[],a=this.model,i=0;i<a.length;i++)if(a[i].id==e){t=a[i];for(var l=0;l<t.allObject.length;l++)n.push(t.allObject[l].dbId.get())}this.viewer.restoreColorMaterial(n,e)}},{key:"changeAllItemsColor",value:function(){for(var e=[],t=this.model,n=0;n<t.length;n++){for(var a,i=[],l=0;l<t[n].allObject.length;l++)i.push(t[n].allObject[l].dbId.get());a=t[n].color.get(),e.push({ids:i,color:a,id:t[n].id})}this.viewer.colorAllMaterials(e)}},{key:"restoreAllItemsColor",value:function(){for(var e=[],t=this.model,n=0;n<t.length;n++){for(var a=[],i=0;i<t[n].allObject.length;i++)a.push(t[n].allObject[i].dbId.get());e.push({ids:a,id:t[n].id})}this.viewer.restoreAllMaterialColor(e)}},{key:"deleteNoteItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=this.model,i=n.confirm().ok("Delete !").title("Do you want to remove it?").cancel("Cancel").clickOutsideToClose(!0);n.show(i).then(function(n){if(null!=t){for(var i=0;i<a.length;i++)if(a[i].id==e)for(var l=0;l<a[i].allObject.length;l++)if(a[i].allObject[l].dbId==t){a[i].allObject.splice(l,1);break}}else for(var o=0;o<a.length;o++)if(a[o].id==e){a.splice(o,1);break}},function(){})}},{key:"changeAllIcon",value:function(e,t){for(var n=this.model,a=0;a<n.length;a++){var i=document.getElementsByClassName("show"+n[a].id)[0];i.innerHTML='<i class="fa '+e+'" aria-hidden="true"></i>',i.setAttribute("show",t)}}},{key:"renameNote",value:function(e){var t=this.model,a=n.prompt().title("Rename Note").placeholder("Please enter the title").ariaLabel("Rename").clickOutsideToClose(!0).required(!0).ok("Rename").cancel("Cancel");n.show(a).then(function(n){for(var a=0;a<t.length;a++)if(t[a].id==e){t[a].title.set(n);break}},function(){})}},{key:"selectNote",value:function(e){var t=this.model;this._sel=e;var n=document.getElementsByClassName("allItems")[0];n.innerHTML="";var a=angular.element(n),i=angular.element("<div></div>"),s=angular.element("<md-list>      </md-list>");if(a.append(i),a.append(s),null!=e){for(var r=0;r<t.length;r++)if(t[r].id==e){var d=angular.element("<h3>Note Selected : "+t[r].title.get()+"</h3>");if(i.append(d),t[r].allObject.length>0)for(var c=0;c<t[r].allObject.length;c++){var u="\n                  <md-list-item>\n                    <p>"+t[r].allObject[c].name.get()+'</p>\n        \n                    <md-button class="i_btn" aria-label="delete_item" ng-click="execute_func(\'delete\',\''+t[r].id.get()+"','"+t[r].allObject[c].dbId+'\')">\n                      <i class="fa fa-trash" aria-hidden="true"></i>\n                    </md-button>\n                  </md-list-item>\n                ';s.append(u)}else s.append("<h5>No item inside</h5>")}}else s.append("<h5>No item selected</h5>");o(i)(l),o(s)(l)}},{key:"createitem",value:function(e,t,n){var a="<md-list-item>\n          <p class=\"noteTitle\" ng-click=\"execute_func('selectItem','"+t.id.get()+"')\">"+t.title.get()+'</p>\n\n          <md-button class="i_btn" aria-label="add_item" id='+t.id.get()+" ng-click=\"execute_func('addItem','"+t.id.get()+'\')">\n            <i class="fa fa-plus" aria-hidden="true"></i>\n          </md-button>\n\n          \x3c!-- <input class="i_btn input_color" value="'+t.color.get()+"\" id=\"i_color\" type='color' name='"+t.id.get()+"' ng-change=\"execute_func('changeColor','"+t.id.get()+'\')" ng-model="color'+n+'"/> --\x3e\n          <input class="i_btn input_color" value="'+t.color.get()+"\" id=\"i_color\" type='color' name='"+t.id.get()+"'/>\n\n          <md-button class=\"i_btn show"+t.id.get()+'" id='+t.id.get()+" aria-label=\"view\" ng-click=\"execute_func('view','"+t.id.get()+'\')" show="false">\n            <i class="fa fa-eye" aria-hidden="true"></i>\n          </md-button>\n\n          <md-button class="i_btn" id='+t.id.get()+" aria-label=\"rename\" ng-click=\"execute_func('rename','"+t.id.get()+'\')">\n            <i class="fa fa-pencil" aria-hidden="true"></i>\n          </md-button>\n\n          <md-button class="i_btn" id='+t.id.get()+" aria-label=\"delete\" ng-click=\"execute_func('delete','"+t.id.get()+'\')">\n            <i class="fa fa-trash" aria-hidden="true"></i>\n          </md-button>\n\n          <md-button class="i_btn" id='+t.id.get()+" aria-label=\"info\" ng-click=\"execute_func('info','"+t.id.get()+'\')">\n            <i class="fa fa-comment" aria-hidden="true"></i>\n          </md-button>\n\n          <md-button class="i_btn" id='+t.id.get()+" aria-label=\"info\" ng-click=\"execute_func('file','"+t.id.get()+'\')">\n            <i class="fa fa-paperclip" aria-hidden="true"></i>\n          </md-button>\n\n        </md-list-item>',i=angular.element(a);e.append(i),o(i)(l)}},{key:"viewOrHide",value:function(e){var t=document.getElementsByClassName("show"+e)[0];"false"==t.getAttribute("show")?(t.setAttribute("show","true"),this.changeItemColor(e),t.innerHTML='<i class="fa fa-eye-slash" aria-hidden="true"></i>'):(this.restoreColor(e),t.setAttribute("show","false"),t.innerHTML='<i class="fa fa-eye" aria-hidden="true"></i>')}},{key:"changeContainer",value:function(e,t){e.innerHTML="";var n=angular.element(e),a=angular.element("<md-list>      </md-list>");if(n.append(a),o(a)(l),t.length>0)for(var i=0;i<t.length;i++){var s=t[i];this.createitem(a,s,i)}else a.append("<h1>No note created ! create one</h1>");this.selectNote(this._sel);for(var r=this,d=document.getElementsByClassName("input_color"),c=0;c<d.length;c++)d[c].onchange=function(){r.changeColorInHub(this.name,this.value)}}},{key:"DetailPanel",value:function(e){var t=this,n=this.model;null==this.detailPanelContent&&(this.detailPanelContent=document.createElement("div"),this.detailPanelContent.className="content"),null==this.detailPanel&&(this.detailPanel=new PanelClass(this.viewer,e),this.detailPanel.initializeMoveHandlers(this.detailPanel.container),this.detailPanel.container.appendChild(this.detailPanel.createCloseButton()),this.detailPanel.container.style.right="0px",this.detailPanel.container.style.width="400px",this.detailPanel.container.style.height="600px",this.detailPanel.container.padding="0px");for(var a=0;a<n.length;a++)if(n[a].id==e){this._selected=n[a];break}var i=document.createElement("div");i.className="form_div";var l=document.createElement("div");l.className="textarea_div";var o=document.createElement("textarea");o.className="form-control",o.setAttribute("rows","2"),o.id=e,o.placeholder="add texte",o.onclick=function(){o.focus()},l.appendChild(o);var s=document.createElement("div");s.className="send_button_div";var r=document.createElement("button");r.className="btn btn-block",r.textContent="Add",r.id=e,r.onclick=function(){var e=document.querySelector("textarea[id='"+r.id+"']").value;if(document.querySelector("textarea[id='"+r.id+"']").value="",""!=e&&""!=e.trim()){var n=new MessageModel;n.id.set(newGUID()),n.owner.set(t.user.id),n.username.set(t.user.username),n.date.set(Date.now()),n.message.set(e),t._selected.notes.push(n)}},s.appendChild(r),i.appendChild(l),i.appendChild(s),this.detailPanel.setVisible(!0),n.bind(function(){t.DisplayMessage(i)})}},{key:"DisplayMessage",value:function(e){var t=this,a=document.createElement("div");a.className="messageContainer";for(var i=0;i<this._selected.notes.length;i++){var l=document.createElement("div");l.className="message_div";var o=document.createElement("div");o.className="_message";var s=document.createElement("div");s.className="message_owner",s.innerText=this._selected.notes[i].username.get();var r=document.createElement("div");r.className="message_date";var d=new Date(parseInt(this._selected.notes[i].date));r.innerText=d.getDate()+"/"+d.getMonth()+"1/"+d.getFullYear();var c=document.createElement("div");c.className="message_content";var u=document.createElement("div");if(u.className="message_texte",u.innerHTML=this._selected.notes[i].message,this._selected.notes[i].owner==this.user.id){var h=document.createElement("div");h.className="close_div";var m=document.createElement("span");m.innerHTML="X",m.className="close",m.id=this._selected.notes[i].id,m.onclick=function(){var a=this,i=n.confirm().ok("Delete !").title("Do you want to remove it?").cancel("Cancel").clickOutsideToClose(!0);n.show(i).then(function(n){t.deteteMessage(a.id,e)},function(){})},h.appendChild(m),c.appendChild(h)}c.appendChild(u),o.appendChild(s),o.appendChild(c),l.appendChild(r),l.appendChild(o),a.appendChild(l)}this.detailPanelContent.innerHTML="",this.detailPanelContent.appendChild(a),this.detailPanelContent.appendChild(e),this.detailPanel.setTitle(this._selected.title.get()),this.detailPanel.container.appendChild(this.detailPanelContent);var f=document.getElementsByClassName("messageContainer")[0];f.scrollTop=f.scrollHeight}},{key:"deteteMessage",value:function(e,t){for(var n=0;n<this._selected.notes.length;n++)if(this._selected.notes[n].id==e){this._selected.notes.splice(n,1);break}}},{key:"DownloadFile",value:function(e){for(var t,n=0;n<this._file_selected.files.length;n++)if((t=this._file_selected.files[n])._info.id==e){t.load(function(e,n){if(e instanceof Path){var a=document.createElement("a");a.setAttribute("href","/sceen/_?u="+e._server_id),a.setAttribute("download",t.name),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)}});break}}},{key:"RemoveFile",value:function(e){var t=this,a=n.confirm().ok("Delete !").title("Do you want to remove it?").cancel("Cancel").clickOutsideToClose(!0);n.show(a).then(function(n){for(var a=0;a<t._file_selected.files.length;a++)if(t._file_selected.files[a]._info.id==e){t._file_selected.files.splice(a,1);break}},function(){})}},{key:"handle_files",value:function(e){var t;if(e.length>0)for(var n=0;n<e.length;n++)t=new Path(e[n]),this._file_selected.files.force_add_file(e[n].name,t,{id:newGUID()})}},{key:"DisplayFilePanel",value:function(e){var t=this,n=this.model;if(null==this.filePanel){this.filePanel=new PanelClass(this.viewer,e),this.filePanel.initializeMoveHandlers(this.filePanel.container),this.filePanel.container.appendChild(this.filePanel.createCloseButton()),this.filePanel.container.style.right="0px",this.filePanel.container.style.width="400px",this.filePanel.container.style.height="600px",this.filePanel.container.padding="0px",this.filePanelContent=document.createElement("div"),this.filePanelContent.className="file_panel_content";var a=document.createElement("div");a.className="dragDrop";var i=document.createElement("input");i.type="file",i.id="modal-new-dropzone-input",i.setAttribute("multiple","true"),i.className="modal-new-dropzone-input",i.onchange=function(){return t.handle_files(i.files)};var l=document.createElement("label");l.innerHTML='\n                              <span class="modal-new-span-upload">\n                                click to Choose files to upload or Drop them here\n                              </span>\n                              <ul id="modal-new-list-upload"></ul>',l.className="text-center",l.ondrop=function(e){e.stopPropagation(),e.preventDefault(),t.handle_files(e.dataTransfer.files)},l.ondragover=function(e){e.preventDefault()},l.htmlFor="modal-new-dropzone-input",a.appendChild(i),a.appendChild(l),this.filePanelContent.appendChild(a);var o=document.createElement("div");o.className="files_div",this.filePanelContent.appendChild(o),this.filePanel.container.appendChild(this.filePanelContent)}this.filePanel.setVisible(!0);for(var s=0;s<n.length;s++)if(n[s].id==e){this._file_selected=n[s];break}this.filePanel.setTitle(this._file_selected.title.get()),n.bind(function(){t.files_display()})}},{key:"displayItem",value:function(e,t){var n='<md-list-item>\n                  <p class="noteTitle">'+e.name.get()+'</p>\n\n                  <md-button class="i_btn" aria-label="add_item" id='+e._info.id.get()+" ng-click=\"execute_func('delete_file','"+e._info.id.get()+'\')">\n                    <i class="fa fa-trash" aria-hidden="true"></i>\n                  </md-button>\n\n                  <md-button class="i_btn" aria-label="add_item" id='+e._info.id.get()+" ng-click=\"execute_func('download','"+e._info.id.get()+'\')">\n                    <i class="fa fa-download" aria-hidden="true"></i>\n                  </md-button>\n                </md-list-item>',a=angular.element(n);t.append(a),o(a)(l)}},{key:"files_display",value:function(){var e=document.getElementsByClassName("files_div")[0];e.innerHTML="";var t,n=angular.element(e),a=angular.element("<md-list>        </md-list>");n.append(a),o(a)(l);for(var i=0;i<this._file_selected.files.length;i++)t=this._file_selected.files[i],this.displayItem(t,a)}}]),PannelAnnotation}();Autodesk.Viewing.theExtensionManager.registerExtension("PannelAnnotation",s)}]),e._createClass=t,e._classCallCheck=_classCallCheck}).call(window,window);

},{}],10:[function(require,module,exports){
(function(e){"use strict";var t=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),n=require("spinal-lib-forgefile/endPoint");function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}angular.module("app.spinalforge.plugin").run(["spinalModelDictionary","$mdDialog","$mdToast","authService","$rootScope","$compile","$routeParams","ngSpinalCore",function(e,i,l,a,o,s,d,r){var c=function(){function PannelendPoint(e,t){var n=this;_classCallCheck(this,PannelendPoint),Autodesk.Viewing.Extension.call(this,e,t),e.registerContextMenuCallback("rightClickMenu",function(e,t){e.push({title:"See Annotation",target:function(){var e=n.viewer.getSelection();if(1==e.length){document.getElementById("search").value=e[0];var t=document.getElementById("allList");n.getContainer(e[0],function(e){n.changeContainer(t,e)})}else alert("you must select 1 item")}})}),this.viewer=e,this.panel=null,this.user=a.get_user(),this.detailPanelContent=null,this.detailPanel=null,this.filePanel=null,this.filePanelContent=null,this._selected=null,this._sel=null,this._file_selected=null,o.execute_func_endpoint=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;switch(e){case"addItem":n.AddItems(t);break;case"changeColor":n.changeColorInHub(t);break;case"view":n.setview(t);break;case"rename":n.renameEndPoint(t);break;case"delete":n.deleteEndPointItem(t,i);break;case"info":n.DetailPanel(t);break;case"selectItem":n.selectEndPoint(t);break;case"file":n.DisplayFilePanel(t);break;case"download":n.DownloadFile(t);break;case"delete_file":n.RemoveFile(t)}}}return t(PannelendPoint,[{key:"load",value:function(){return this.viewer.toolbar?this.createUI():(this.onToolbarCreatedBinded=this.onToolbarCreated.bind(this),this.viewer.addEventListener(av.TOOLBAR_CREATED_EVENT,this.onToolbarCreatedBinded)),!0}},{key:"onToolbarCreated",value:function(){this.viewer.removeEventListener(av.TOOLBAR_CREATED_EVENT,this.onToolbarCreatedBinded),this.onToolbarCreatedBinded=null,this.createUI()}},{key:"unload",value:function(){return this.viewer.toolbar.removeControl(this.subToolbar),!0}},{key:"createUI",value:function(){var e=this;this.panel=new PanelClass(this.viewer,"Endpoint"),this.initialize();var t=new Autodesk.Viewing.UI.Button("Endpoint");t.onClick=function(t){e.panel.isVisible()?e.panel.setVisible(!1):e.panel.setVisible(!0)},t.addClass("fa"),t.addClass("fa-book"),t.addClass("fa-2x"),t.setToolTip("Endpoint"),this.subToolbar=new Autodesk.Viewing.UI.ControlGroup("my-Endpoint"),this.subToolbar.addControl(t),this.viewer.toolbar.addControl(this.subToolbar)}},{key:"initialize",value:function(){var e=this,t=this.panel.createScrollContainer();this.panel.container.appendChild(t);this.my_start=this.start.bind(this,function(n){var l=t,a=n;l.className+=" panelViewer";var o=document.createElement("div");o.className="_container";var s=document.createElement("div");s.className="header";var c=document.createElement("div");c.className="spin row head";var u=document.createElement("div");u.className="col-sm-3 col-md-3 col-xs-3";var h=document.createElement("button");h.className="btn btn-primary btn-sm btn-block",h.innerHTML='<i class="fa fa-pencil-square-o" aria-hidden="true"></i> End point',h.onclick=function(){var t=i.prompt().title("New End point").placeholder("Please enter the title").ariaLabel("New End point").clickOutsideToClose(!0).required(!0).ok("Create!").cancel("Cancel");i.show(t).then(function(t){e.AddEndPoint(t)},function(){})};var m=document.createElement("div");m.className="col-sm-3 col-md-3 col-xs-3";var p=document.createElement("button");p.className="btn btn-primary btn-sm btn-block",p.innerHTML='<i class="fa fa-eye" aria-hidden="true"></i> View',p.onclick=function(){e.changeEndPointsColor(),e.changeAllIcon("fa-eye-slash","true")};var f=document.createElement("div");f.className="col-sm-3 col-md-3 col-xs-3";var v=document.createElement("button");v.className="btn btn-primary btn-sm btn-block",v.innerHTML='<i class="fa fa-eye-slash" aria-hidden="true"></i> Hide',v.onclick=function(){e.restoreEndPointsColor(),e.changeAllIcon("fa-eye","false")};var g=document.createElement("div");g.className="col-sm-3 col-md-3 col-xs-3";var b=document.createElement("button");b.className="btn btn-primary btn-sm btn-block",b.innerHTML='<i class="fa fa-eye-slash" aria-hidden="true"></i> export',b.onclick=function(){var t=d.filepath;t=atob(t),console.log(t);var n=t.split("/");console.log(n);var i="",l=void 0;for(l=1;l<n.length-1;l++)i=i+"/"+n[l];i+="/endPoints",r.store(e.model,i).then(function(e){console.log(i)})};var _=document.createElement("div");_.className="list-group allList",_.id="allList";var C=document.createElement("div");C.className="list-group endPoints";var k=document.createElement("div");k.className="spin input-group";var P=document.createElement("span");P.className="icon input-group-addon",P.innerHTML='<i class="fa fa-search" aria-hidden="true"></i>';var y=document.createElement("input");y.className="input form-control toolbar-search-box",y.type="number",y.id="search",y.placeholder="item id",y.onclick=function(){y.focus()},y.oninput=function(){""!=y.value?e.getContainer(parseInt(y.value),function(t){e.changeContainer(_,t)}):e.changeContainer(_,a)},u.appendChild(h),m.appendChild(p),f.appendChild(v),g.appendChild(b),c.appendChild(u),c.appendChild(m),c.appendChild(f),c.appendChild(g),s.appendChild(c),k.appendChild(P),k.appendChild(y),s.appendChild(k),o.appendChild(s),o.appendChild(_),o.appendChild(C),l.appendChild(o),a.bind(function(){e.changeContainer(_,a),e.viewOrHide()})}),this.viewer.addEventListener(av.GEOMETRY_LOADED_EVENT,this.my_start)}},{key:"start",value:function(t){var n=this;this.viewer.removeEventListener(av.GEOMETRY_LOADED_EVENT,this.my_start),e.init().then(function(e){e&&(e.endPointPlugin?e.endPointPlugin.load(function(e){n.model=e,t(n.model)}):(n.model=new Lst,e.add_attr({endPointPlugin:new Ptr(n.model)}),t(n.model)))})}},{key:"AddEndPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#000000",i=this.model;console.log(i);var l=newGUID(),a=new n.endPoint;a.title.set(e),a.color.set(t),a.id.set(l),a.date.set(Date.now()),console.log(a);var o=i;o.push(a),i.mod_attr(o)}},{key:"AddItems",value:function(e){var t,n,i=this.viewer.getSelection(),a=this.model;0!=i.length?this.viewer.model.getBulkProperties(i,{propFilter:["name"]},function(i){for(var o=0;o<a.length;o++)if(a[o].id==e){t=a[o].allObject,n=o;break}console.log(t);for(var s=0;s<i.length;s++)t.push(i[s]);a[n].allObject=t;var d=l.simple().content("Item added !").action("OK").highlightAction(!0).hideDelay(0).position("bottom right").parent("body");l.show(d)},function(){console.log("error")}):alert("No model selected !")}},{key:"getContainer",value:function(e,t){t(this.model.filter(function(t){return t.allObject.filter(function(t){return t.dbId.get()==e}).length>0}))}},{key:"changeColorInHub",value:function(e,t){for(var n=this.model,i=0;i<n.length;i++)n[i].id==e&&n[i].color.set(t)}},{key:"changeItemColor",value:function(e){for(var t,n=[],i=this.model,l=0;l<i.length;l++)if(i[l].id==e){t=i[l];for(var a=0;a<t.allObject.length;a++)n.push(t.allObject[a].dbId.get())}this.viewer.setColorMaterial(n,t.color.get(),t.id.get())}},{key:"restoreColor",value:function(e){for(var t,n=[],i=this.model,l=0;l<i.length;l++)if(i[l].id==e){t=i[l];for(var a=0;a<t.allObject.length;a++)n.push(t.allObject[a].dbId.get())}this.viewer.restoreColorMaterial(n,e)}},{key:"changeEndPointsColor",value:function(){for(var e=[],t=this.model,n=0;n<t.length;n++){for(var i,l=[],a=0;a<t[n].allObject.length;a++)l.push(t[n].allObject[a].dbId.get());i=t[n].color.get(),e.push({ids:l,color:i,id:t[n].id})}this.viewer.colorAllMaterials(e)}},{key:"restoreEndPointsColor",value:function(){for(var e=[],t=this.model,n=0;n<t.length;n++){for(var i=[],l=0;l<t[n].allObject.length;l++)i.push(t[n].allObject[l].dbId.get());e.push({ids:i,id:t[n].id})}this.viewer.restoreAllMaterialColor(e)}},{key:"deleteEndPointItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.model,l=i.confirm().ok("Delete !").title("Do you want to remove it?").cancel("Cancel").clickOutsideToClose(!0);i.show(l).then(function(i){if(null!=t){for(var l=0;l<n.length;l++)if(n[l].id==e)for(var a=0;a<n[l].allObject.length;a++)if(n[l].allObject[a].dbId==t){n[l].allObject.splice(a,1);break}}else for(var o=0;o<n.length;o++)if(n[o].id==e){n.splice(o,1);break}},function(){})}},{key:"changeAllIcon",value:function(e,t){for(var n=this.model,i=0;i<n.length;i++){var l=document.getElementsByClassName("show"+n[i].id)[0];l.innerHTML='<i class="fa '+e+'" aria-hidden="true"></i>',l.setAttribute("show",t)}}},{key:"renameEndPoint",value:function(e){var t=this.model,n=i.prompt().title("Rename EndPoint").placeholder("Please enter the title").ariaLabel("Rename").clickOutsideToClose(!0).required(!0).ok("Rename").cancel("Cancel");i.show(n).then(function(n){for(var i=0;i<t.length;i++)if(t[i].id==e){t[i].title.set(n);break}},function(){})}},{key:"selectEndPoint",value:function(e){var t=this.model;this._sel=e;var n=document.getElementsByClassName("endPoints")[0];n.innerHTML="";var i=angular.element(n),l=angular.element("<div></div>"),a=angular.element("<md-list>      </md-list>");if(i.append(l),i.append(a),null!=e){for(var d=0;d<t.length;d++)if(t[d].id==e){var r=angular.element("<h3>EndPoint Selected : "+t[d].title.get()+"</h3>");if(l.append(r),t[d].allObject.length>0)for(var c=0;c<t[d].allObject.length;c++){var u="\n                  <md-list-item>\n                    <p>"+t[d].allObject[c].name.get()+'</p>\n        \n                    <md-button class="i_btn" aria-label="delete_item" ng-click="execute_func_endpoint(\'delete\',\''+t[d].id.get()+"','"+t[d].allObject[c].dbId+'\')">\n                      <i class="fa fa-trash" aria-hidden="true"></i>\n                    </md-button>\n                  </md-list-item>\n                ';a.append(u)}else a.append("<h5>No item inside</h5>")}}else a.append("<h5>No item selected</h5>");s(l)(o),s(a)(o)}},{key:"createitem",value:function(e,t,n){var i="<md-list-item>\n          <p class=\"endpointTitle\" ng-click=\"execute_func_endpoint('selectItem','"+t.id.get()+"')\">"+t.title.get()+'</p>\n\n          <md-button class="i_btn" aria-label="add_item" id='+t.id.get()+" ng-click=\"execute_func_endpoint('addItem','"+t.id.get()+'\')">\n            <i class="fa fa-plus" aria-hidden="true"></i>\n          </md-button>\n\n          \x3c!-- <input class="i_btn input_color" value="'+t.color.get()+"\" id=\"i_color\" type='color' name='"+t.id.get()+"' ng-change=\"execute_func_endpoint('changeColor','"+t.id.get()+'\')" ng-model="color'+n+'"/> --\x3e\n          <input class="i_btn input_color" value="'+t.color.get()+"\" id=\"i_color\" type='color' name='"+t.id.get()+"'/>\n\n          <md-button class=\"i_btn show"+t.id.get()+'" id='+t.id.get()+" aria-label=\"view\" ng-click=\"execute_func_endpoint('view','"+t.id.get()+'\')" show="false">\n            <i class="fa fa-eye" aria-hidden="true"></i>\n          </md-button>\n\n          <md-button class="i_btn" id='+t.id.get()+" aria-label=\"rename\" ng-click=\"execute_func_endpoint('rename','"+t.id.get()+'\')">\n            <i class="fa fa-pencil" aria-hidden="true"></i>\n          </md-button>\n\n          <md-button class="i_btn" id='+t.id.get()+" aria-label=\"delete\" ng-click=\"execute_func_endpoint('delete','"+t.id.get()+'\')">\n            <i class="fa fa-trash" aria-hidden="true"></i>\n          </md-button>\n\n          <md-button class="i_btn" id='+t.id.get()+" aria-label=\"info\" ng-click=\"execute_func_endpoint('info','"+t.id.get()+'\')">\n            <i class="fa fa-comment" aria-hidden="true"></i>\n          </md-button>\n\n          <md-button class="i_btn" id='+t.id.get()+" aria-label=\"info\" ng-click=\"execute_func_endpoint('file','"+t.id.get()+'\')">\n            <i class="fa fa-paperclip" aria-hidden="true"></i>\n          </md-button>\n\n        </md-list-item>',l=angular.element(i);e.append(l),s(l)(o)}},{key:"viewOrHide",value:function(){var e=this.model;console.log(e);var t=[],n=[],i=0,l=0;console.log(e);for(l=0;l<e.length;l++)1==e[l].display.get()?t.push(e[l]):n.push(e[l]);for(console.log("my display tab_true"),console.log(t),console.log(n),l=0;l<t.length;l++)console.log(t[l].title.get()),this.changeItemColor(t[l].id.get());for(i=0;i<n.length;i++)console.log(n[i].id.get()),this.restoreColor(n[i].id.get())}},{key:"changeContainer",value:function(e,t){e.innerHTML="";var n=angular.element(e),i=angular.element("<md-list>      </md-list>");if(n.append(i),s(i)(o),t.length>0)for(var l=0;l<t.length;l++){var a=t[l];this.createitem(i,a,l)}else i.append("<h1>No endpoint created ! create one</h1>");this.selectEndPoint(this._sel);for(var d=this,r=document.getElementsByClassName("input_color"),c=0;c<r.length;c++)r[c].onchange=function(){d.changeColorInHub(this.name,this.value)}}},{key:"DetailPanel",value:function(e){var t=this,n=this.model;null==this.detailPanelContent&&(this.detailPanelContent=document.createElement("div"),this.detailPanelContent.className="content"),null==this.detailPanel&&(this.detailPanel=new PanelClass(this.viewer,e),this.detailPanel.initializeMoveHandlers(this.detailPanel.container),this.detailPanel.container.appendChild(this.detailPanel.createCloseButton()),this.detailPanel.container.style.right="0px",this.detailPanel.container.style.width="400px",this.detailPanel.container.style.height="600px",this.detailPanel.container.padding="0px");for(var i=0;i<n.length;i++)if(n[i].id==e){this._selected=n[i];break}var l=document.createElement("div");l.className="form_div";var a=document.createElement("div");a.className="textarea_div";var o=document.createElement("textarea");o.className="form-control",o.setAttribute("rows","2"),o.id=e,o.placeholder="add texte",o.onclick=function(){o.focus()},a.appendChild(o);var s=document.createElement("div");s.className="send_button_div";var d=document.createElement("button");d.className="btn btn-block",d.textContent="Add",d.id=e,d.onclick=function(){var e=document.querySelector("textarea[id='"+d.id+"']").value;if(document.querySelector("textarea[id='"+d.id+"']").value="",""!=e&&""!=e.trim()){var n=new MessageModel;n.id.set(newGUID()),n.owner.set(t.user.id),n.username.set(t.user.username),n.date.set(Date.now()),n.message.set(e),t._selected.endpoints.push(n)}},s.appendChild(d),l.appendChild(a),l.appendChild(s),this.detailPanel.setVisible(!0),n.bind(function(){t.DisplayMessage(l)})}},{key:"DisplayMessage",value:function(e){var t=this,n=document.createElement("div");n.className="messageContainer";for(var l=0;l<this._selected.endpoints.length;l++){var a=document.createElement("div");a.className="message_div";var o=document.createElement("div");o.className="_message";var s=document.createElement("div");s.className="message_owner",s.innerText=this._selected.endpoints[l].username.get();var d=document.createElement("div");d.className="message_date";var r=new Date(parseInt(this._selected.endpoints[l].date));d.innerText=r.getDate()+"/"+r.getMonth()+"1/"+r.getFullYear();var c=document.createElement("div");c.className="message_content";var u=document.createElement("div");if(u.className="message_texte",u.innerHTML=this._selected.endpoints[l].message,this._selected.endpoints[l].owner==this.user.id){var h=document.createElement("div");h.className="close_div";var m=document.createElement("span");m.innerHTML="X",m.className="close",m.id=this._selected.endpoints[l].id,m.onclick=function(){var n=this,l=i.confirm().ok("Delete !").title("Do you want to remove it?").cancel("Cancel").clickOutsideToClose(!0);i.show(l).then(function(i){t.deteteMessage(n.id,e)},function(){})},h.appendChild(m),c.appendChild(h)}c.appendChild(u),o.appendChild(s),o.appendChild(c),a.appendChild(d),a.appendChild(o),n.appendChild(a)}this.detailPanelContent.innerHTML="",this.detailPanelContent.appendChild(n),this.detailPanelContent.appendChild(e),this.detailPanel.setTitle(this._selected.title.get()),this.detailPanel.container.appendChild(this.detailPanelContent);var p=document.getElementsByClassName("messageContainer")[0];p.scrollTop=p.scrollHeight}},{key:"setview",value:function(e){var t=this.model;console.log(t);for(var n=0;n<t.length;n++)t[n].id.get()==e&&(console.log(t[n].display.get()),0==t[n].display.get()?t[n].display.set(!0):t[n].display.set(!1),console.log(t[n].display.get()))}},{key:"deteteMessage",value:function(e,t){for(var n=0;n<this._selected.endpoints.length;n++)if(this._selected.endpoints[n].id==e){this._selected.endpoints.splice(n,1);break}}},{key:"DownloadFile",value:function(e){for(var t,n=0;n<this._file_selected.files.length;n++)if((t=this._file_selected.files[n])._info.id==e){t.load(function(e,n){if(e instanceof Path){var i=document.createElement("a");i.setAttribute("href","/sceen/_?u="+e._server_id),i.setAttribute("download",t.name),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}});break}}},{key:"RemoveFile",value:function(e){var t=this,n=i.confirm().ok("Delete !").title("Do you want to remove it?").cancel("Cancel").clickOutsideToClose(!0);i.show(n).then(function(n){for(var i=0;i<t._file_selected.files.length;i++)if(t._file_selected.files[i]._info.id==e){t._file_selected.files.splice(i,1);break}},function(){})}},{key:"handle_files",value:function(e){var t;if(e.length>0)for(var n=0;n<e.length;n++)t=new Path(e[n]),this._file_selected.files.force_add_file(e[n].name,t,{id:newGUID()})}},{key:"DisplayFilePanel",value:function(e){var t=this,n=this.model;if(null==this.filePanel){this.filePanel=new PanelClass(this.viewer,e),this.filePanel.initializeMoveHandlers(this.filePanel.container),this.filePanel.container.appendChild(this.filePanel.createCloseButton()),this.filePanel.container.style.right="0px",this.filePanel.container.style.width="400px",this.filePanel.container.style.height="600px",this.filePanel.container.padding="0px",this.filePanelContent=document.createElement("div"),this.filePanelContent.className="file_panel_content";var i=document.createElement("div");i.className="dragDrop";var l=document.createElement("input");l.type="file",l.id="modal-new-dropzone-input",l.setAttribute("multiple","true"),l.className="modal-new-dropzone-input",l.onchange=function(){return t.handle_files(l.files)};var a=document.createElement("label");a.innerHTML='\n                              <span class="modal-new-span-upload">\n                                click to Choose files to upload or Drop them here\n                              </span>\n                              <ul id="modal-new-list-upload"></ul>',a.className="text-center",a.ondrop=function(e){e.stopPropagation(),e.preventDefault(),t.handle_files(e.dataTransfer.files)},a.ondragover=function(e){e.preventDefault()},a.htmlFor="modal-new-dropzone-input",i.appendChild(l),i.appendChild(a),this.filePanelContent.appendChild(i);var o=document.createElement("div");o.className="files_div",this.filePanelContent.appendChild(o),this.filePanel.container.appendChild(this.filePanelContent)}this.filePanel.setVisible(!0);for(var s=0;s<n.length;s++)if(n[s].id==e){this._file_selected=n[s];break}this.filePanel.setTitle(this._file_selected.title.get()),n.bind(function(){t.files_display()})}},{key:"displayItem",value:function(e,t){var n='<md-list-item>\n                  <p class="endpointTitle">'+e.name.get()+'</p>\n\n                  <md-button class="i_btn" aria-label="add_item" id='+e._info.id.get()+" ng-click=\"execute_func_endpoint('delete_file','"+e._info.id.get()+'\')">\n                    <i class="fa fa-trash" aria-hidden="true"></i>\n                  </md-button>\n\n                  <md-button class="i_btn" aria-label="add_item" id='+e._info.id.get()+" ng-click=\"execute_func_endpoint('download','"+e._info.id.get()+'\')">\n                    <i class="fa fa-download" aria-hidden="true"></i>\n                  </md-button>\n                </md-list-item>',i=angular.element(n);t.append(i),s(i)(o)}},{key:"files_display",value:function(){var e=document.getElementsByClassName("files_div")[0];e.innerHTML="";var t,n=angular.element(e),i=angular.element("<md-list>        </md-list>");n.append(i),s(i)(o);for(var l=0;l<this._file_selected.files.length;l++)t=this._file_selected.files[l],this.displayItem(t,i)}}]),PannelendPoint}();Autodesk.Viewing.theExtensionManager.registerExtension("PannelendPoint",c)}]),e._createClass=t,e._endPoint=n,e._classCallCheck=_classCallCheck}).call(window,window);

},{"spinal-lib-forgefile/endPoint":15}],11:[function(require,module,exports){
"use strict";angular.module("app.spinalcom").factory("authService",["$q","ngSpinalCore","config","$http",function(e,r,n,t){var o={},a={username:"",password:"",id:""},s=!1;o.save_user=function(e,r,n){a.username=e,a.password=r,a.id=n,window.localStorage.setItem("spinalhome_cfg",btoa(JSON.stringify(a)))},o.get_user=function(){var e=window.localStorage.getItem("spinalhome_cfg");return e&&(a=JSON.parse(atob(e))),a},o.logout=function(e,r){""!=a.username&&(o.save_user("","",""),location.reload())},o.login=function(a,u){var c=e.defer();return t.get("/get_user_id?u="+a+"&p="+u).then(function(e){var t=parseInt(e.data),l=0;if(-1!=t){for(r.connect("http://"+t+":"+u+"@"+n.spinalhub_url+":"+n.spinalhub_port+"/"),o.save_user(a,u,t),s=!0,c.resolve(),l=0;l<i.length;l++)i[l].resolve();i=[]}else{for(c.reject("Login Error: username / password pair not found."),l=0;l<i.length;l++)i[l].reject();i=[]}},function(e){c.reject("Connection Error: Imposible to connect to the server.");for(var r=0;r<i.length;r++)i[r].reject();i=[]}),c.promise},o.is_Connected=function(){return s};var i=[];return o.wait_connect=function(){var r=e.defer();return 1==s?r.resolve():i.push(r),r.promise},o}]);

},{}],12:[function(require,module,exports){
"use strict";angular.module("app.services").factory("goldenLayoutService",["$q","$window","$templateCache","$rootScope","$compile",function(e,t,n,o,r){var a={content:[{type:"row",content:[{isClosable:!1,title:"Viewer",type:"component",componentName:"SpinalHome",componentState:{template:"forgeviewer.html",controller:"forgeViewerCtrl"}}]}]},c=0,i={init:function(){0==c&&((c=new GoldenLayout(a,$("#g-layout"))).registerComponent("SpinalHome",function(e,t){var a=e.getElement();""==t.template?(a.html(),r(a.contents())(o)):(a.html('<div class="gpannel-content" ng-controller="'+t.controller+'" ng-cloak>'+n.get(t.template)+"</div>"),r(a.contents())(o))}),c.init(),angular.element(t).bind("resize",function(){c.updateSize()}),o.$emit("GoldenLayout_READY"))},wait_ready:function(){return e(function(e,t){o.$on("GoldenLayout_READY",function(){e()})})},createChild:function(e){c.root.contentItems[0].addChild(e)},createDragSource:function(e,t){c.createDragSource(e,t)}};return i}]).factory("layout_uid",function(){var e=0;return{get:function(){return e++}}});

},{}],13:[function(require,module,exports){
"use strict";angular.module("app.spinalcom").factory("ngSpinalCore",["$q",function(n){var e={conn:0,connect:function(n){e.conn=spinalCore.connect(n)},store:function(o,r){var t=n.defer();return spinalCore.store(e.conn,o,r,function(n){t.resolve(n)},function(){t.reject()}),t.promise},load:function(o){var r=n.defer();return spinalCore.load(e.conn,o,function(n){r.resolve(n)},function(){r.reject()}),r.promise},load_type:function(o,r){var t=n.defer();return spinalCore.load_type(e.conn,o,r,function(n){t.resolve(n)},function(){t.reject()}),t.promise},load_right:function(o){var r=n.defer();return spinalCore.load_right(e.conn,o,function(n){r.resolve(n)},function(){r.reject()}),r.promise},share_model:function(n,o,r,t){return spinalCore.share_model(e.conn,n,o,r,t)}};return e}]);

},{}],14:[function(require,module,exports){
"use strict";angular.module("app.spinalcom").factory("spinalModelDictionary",["$q","ngSpinalCore","config","authService","$routeParams","$location",function(e,o,r,n,t,a){var l={model:0,init:function(){var r=e.defer();return 0==l.model?n.wait_connect().then(function(){n.get_user();var e=t.filepath;console.log(e),e&&(e=atob(e),o.load(e).then(function(e){l.model=e,console.log(e),r.resolve(e)},function(){var o="not able to load : "+e;console.error(o),a.replace("/drive/"),r.reject(o)}))},function(){var e="not able to load : "+path;console.error(e),a.replace("/drive/"),r.reject(e)}):r.resolve(l.model),r.promise}};return l}]);

},{}],15:[function(require,module,exports){
(function(e){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var t=module.exports={},n=function(e){function endpoint_TimeSeries(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];_classCallCheck(this,endpoint_TimeSeries);var e=_possibleConstructorReturn(this,(endpoint_TimeSeries.__proto__||Object.getPrototypeOf(endpoint_TimeSeries)).call(this));return e.add_attr({time:[],value:[]}),e}return _inherits(endpoint_TimeSeries,Model),endpoint_TimeSeries}();t.endpoint_TimeSeries=n;var o=function(e){function endPoint(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];_classCallCheck(this,endPoint);var e=_possibleConstructorReturn(this,(endPoint.__proto__||Object.getPrototypeOf(endPoint)).call(this)),t=new n;return e.add_attr({display:!1,id:"",title:"",color:"",username:"",date:Date.now(),currentValue:0,TimeSerie:new Ptr(t),allObject:[]}),e}return _inherits(endPoint,Model),endPoint}();t.endPoint=o,e._classCallCheck=_classCallCheck,e._possibleConstructorReturn=_possibleConstructorReturn,e._inherits=_inherits,e._exports=t,e.endpoint_TimeSeries=n,e.endPoint=o}).call(window,window);

},{}]},{},[2,1,3,8,13,14,12,11,6,7,4,5,9,10])
//# sourceMappingURL=app.compile.min.js.map
